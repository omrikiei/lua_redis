TODO:
- Write more extensive tests, include pubsub.
- Test con.nection with local socket.
- Benchmark performance.
